<!DOCTYPE html>
<html style="font-size: 64.6875px">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>FFPAY | Login</title>

    <link href="../css/bootstrap.min.css"  rel="stylesheet">
    <link href="../font-awesome/css/font-awesome.css"  rel="stylesheet">
    <link href="../css/animate.css"  rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/common.css" rel="stylesheet">
    <link href="../css/transferInfo.css" rel="stylesheet">
    <!-- Mainly scripts -->
    <script src="../js/jquery-3.1.1.min.js"  type= "text/javascript"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>

<body id="protoPreview" class=" overflowHidden">
	
    <div class="body-wrapper">
    	<div class="phone-view-box">
    		<div class="model-wrapper" style="transform: scale(0.72);">
    			<div class="mobile-model"></div>
    		</div>
    		<div id="appContainer" class="mobile-wrapper">
    			<div id="pageContainer" class="pageContainer" data-scale="72">
    				<!-- 顶部显示区域 -->
    				<div class = "topBox_background">
                            <div class = "topBox"> 
                                <div id ="returnPage" class="leftarrow"></div>
                                <div id="tansferStatus" class = "text">
                                    Transfer
                                </div>
                            </div>
                     </div>
                     <div class="InfoArea">
                     		<div class="headImg img" style="background-image: url(../img/transfer/head2.jpg)"></div>
                     		<div id="frdNm" class="FriNm">Van Halen</div>
                     		<div id="frdCard" class="FriBankNo">6226-6678-3451-6785</div>
	                     	<!-- 金额栏目 -->
		    				<div class="msgArea">			
		    					<div class="msgdetail">
			    					<div class="msgTitle">Amount</div>
			    					<input id= "msgAmount" class="msgAmount" placeholder="100 HKD" ></input>
		    					</div>
			    				<div class="msgTitle2">Message</div>
			    				<input id = "msgContent" class="msgContent" placeholder="No more than 30 words" ></input>
		    					
		    					
		    				</div>
                     </div>
                     
                      <div id="page1" class="page1">
	    				<div id ="upperBoxArea" class="upperBox">
	    					<!-- <div class="offerdetail">
	    						<div class= "cardTitle">My Default Bank Card</div>
	    						<div class="bankGicon" style="background-image: url(../img/common/hsbc.png)"></div>
	    						<div id = "bfrCard1" class="detail detailtitle">HSBC</div>
		    					<div id = "cfrCard1" class="detail detailcontent">Bank Account</div>
	    						<div id = "nfrCard1" class="detail detailbottom">886-98764-879</div>
	    						<div id = "ifrCard1"  class="circleIcon" ></div>
	    						<div id = "frCard1" class="circleIcon1" onclick="setFromCard(this)"></div>
	    					</div>  
	    					<div class="offerdetail">
    							<div class= "cardTitle">Recommended Bank Card</div>
    							<div class="bankGicon" style="background-image: url(../img/common/boc.png)"></div>					
	    						<div id = "bfrCard2" class="detail detailtitle">Bank Of China</div>
	    						<div id = "cfrCard2" class="detail detailcontent">Master Card</div>
	    						<div id = "nfrCard2" class="detail detailbottom">5236-4978-7889-2314</div>
    						    <div id = "ifrCard2"  class="circleIcon" ></div>
    							<div id = "frCard2" class="circleIcon1" onclick="setFromCard(this)"></div>
	    					</div>
	    					<div class="offerdetail">
	    						<div class= "cardTitle">My Other Bank Card</div>
	    						<div class="bankGicon" style="background-image: url(../img/common/cmb.jpg)"></div>					
	    						<div id = "bfrCard3" class="detail detailtitle">China Merchants Bank</div>
	    						<div id = "cfrCard3" class="detail detailcontent">Master Card</div>
	    						<div id = "nfrCard3" class="detail detailbottom">5236-4978-7889-2314</div>
    						    <div id = "ifrCard3"  class="circleIcon" ></div>
    							<div id = "frCard3" class="circleIcon1" onclick="setFromCard(this)"></div>
	    					</div>    	 -->
	    				</div>	    				
	    				

	    				
	    				
	    			</div>
    				<button id="clearBt" class="bottomBt bt1" >Clear</button>
	    			<button id="nextBt"  class="bottomBt bt2" data-toggle="popover" data-placement="top" 
			data-content="顶部的 Popover 中的一些内容" >Next</button>
    			
    				
    				</div>
    				
    			</div>
    		</div>
    </div>
       


</body>
<script>

$(document).ready(function () {
	/* $('#page2').hide(); */
	/* $('#page2').show(); */
	$("#frdNm").text(getUrlParam("frdNm"));
	$("#frdCard").text(getUrlParam("frdCard"));
	getFromCardList();
	$("#returnPage").bind('click',returnPage);
	$("#clearBt").bind('click',clearFunc);
	$('#nextBt').bind('click',jumptoCardSucess);
	
});
var fromCard = new Array();


function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
        var r = window.location.search.substr(1).match(reg);  //匹配目标参数
        if (r != null) return unescape(r[2]);
        return null; //返回参数值
}
/* 设置转出卡 */
function setFromCard(ele){
	var id = $(ele).attr("id");
	
	if( fromCard.length > 0){
		var fid = fromCard[0];
		$('#i'+ fid).css('box-shadow', '0 0 3px #221f1f');
		$('#' + fid).css('background-color', '#ffffff');
	}
	$('#i'+id).css('box-shadow', '0 0 3px #31a691');
	$(ele).css('background-color', '#31a691');
	fromCard[0] = id;
	fromCard[1] = $('#b'+ id).text();
	fromCard[2] = $('#c'+ id).text();
	fromCard[3] = $('#n'+ id).text();
}
function getFromCardList(){
	var cardHtmlone = "<div class=\"offerdetail\"><div class=\"bankGicon\" style=\"background-image: url("; 
	var pageHtml = ""
	$.ajax({
        async : false,
        type : "get",
        url : "/cardInfos/selCardList",
        contentType: "application/json",
        //这里设置查询条件,如果不设置查询条件，就返回全量列表
        data:{
        	cardTyp:"Debit"
        },
        success: function (res) {         
            for(j = 0,len = res.length; j < len; j++) {
            	if(j == 0){
            		pageHtml += "<div class=\"offerdetail\"><div class= \"cardTitle\">My Default Bank Card</div><div class=\"bankGicon\" style=\"background-image: url(" 
            				+ res[j]["bankLogoAdd"] + ")\"></div> <div id = \"btrCard" + j +"\" class=\"detail detailtitle\">" 
                	+ res[j]["bankCardTyp"] + "</div><div id = \"ctrCard" + j +"\" class=\"detail detailcontent\">" +  res[j]["cardTyp"] 
                	+ "</div><div id = \"ntrCard" + j +"\"  class=\"detail detailbottom\">" + res[j]["cardNo"] 
                	+ "</div><div id = \"itrCard" + j +"\" class=\"circleIcon\" ></div>"
                	+ "<div id = \"trCard" + j +"\" class=\"circleIcon1\" onclick=\"setFromCard(this)\"></div></div>";
            	}else{
            		pageHtml += "<div class=\"offerdetail\"><div class= \"cardTitle\">My Other Bank Card</div><div class=\"bankGicon\" style=\"background-image: url(" 
        				+ res[j]["bankLogoAdd"] + ")\"></div> <div id = \"btrCard" + j +"\" class=\"detail detailtitle\">" 
            	+ res[j]["bankCardTyp"] + "</div><div id = \"ctrCard" + j +"\" class=\"detail detailcontent\">" +  res[j]["cardTyp"] 
            	+ "</div><div id = \"ntrCard" + j +"\"  class=\"detail detailbottom\">" + res[j]["cardNo"] 
            	+ "</div><div id = \"itrCard" + j +"\" class=\"circleIcon\" ></div>"
            	+ "<div id = \"trCard" + j +"\" class=\"circleIcon1\" onclick=\"setFromCard(this)\"></div></div>";
            	}
            	
            } 
            console.log(pageHtml);
            $("#upperBoxArea").html(pageHtml)
        },
        error:function (res) {
            alert(res);
        }
    });
}
function returnPage() {
	window.location.href='./transferHome.html';
};

function clearFunc() {
	$('#msgAmount').val("");
	$('#msgContent').val("");
};

function jumptoCardSucess() {
	var amt = $("#msgAmount").val();
	if(typeof amt == "undefined" || amt == null || amt == ""){
		
    }else{
    	var url = './transToFriSucc.html?frdNm='+getUrlParam("frdNm")+"&frdCard="+getUrlParam("frdCard")+"&amt="+amt;
    	window.location.href= url;
    }
	
};

	
</script>
</html>
